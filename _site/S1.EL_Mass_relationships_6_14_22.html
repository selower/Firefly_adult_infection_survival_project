<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Moria Chambers + Sarah Lower" />

<meta name="date" content="2022-09-22" />

<title>P. pyralis adult infection survival: length and mass analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">P. pyralis adult infection survival: length
and mass analysis</h1>
<h4 class="author">Moria Chambers + Sarah Lower</h4>
<h4 class="date">2022-09-22</h4>

</div>


<div
id="goal-test-common-assumptions-about-firefly-size-elytron-length-and-body-mass-over-the-season-and-across-locations-in-p.-pyralis-fireflies"
class="section level1">
<h1>Goal: Test common assumptions about firefly size (<strong>elytron
length</strong> and <strong>body mass</strong>) over the
<strong>season</strong> and across <strong>locations</strong> in <em>P.
pyralis</em> fireflies</h1>
<p><em>Study design:</em></p>
<p><img src="Experimental_design.png" /></p>
<hr />
<div id="step-1-ready-the-workspace" class="section level2">
<h2>Step 1: Ready the workspace</h2>
<pre class="r"><code>#clear all inputs
rm(list = ls())

#Check for necessary packages
#list.of.packages &lt;- c(&quot;ggplot2&quot;, 
#                      &quot;tidyr&quot;,
#                      &quot;dplyr&quot;,
#                      &quot;Hmisc&quot;,
#                      &quot;qqplotr&quot;,
#                      &quot;ggthemes&quot;,
#                      &quot;fabricatr&quot;,
#                      &quot;gridExtra&quot;,
#                      &quot;grid&quot;,
#                      &quot;kableExtra&quot;,
#                      &quot;sjPlot&quot;,
#                      &quot;cowplot&quot;,
#                      &quot;ggpubr&quot;,
#                      &quot;patchwork&quot;,
#                      &quot;magick&quot;, #so you can use the savekable function
#                      &quot;webshot&quot;, #so you can use the savekable function
#                      &quot;lme4&quot;,
#                      &quot;RcppEigen&quot;)

#should install packages that you don&#39;t have
#new.packages &lt;- list.of.packages[!(list.of.packages %in% installed.packages()[,&quot;Package&quot;])]
#if(length(new.packages)) install.packages(new.packages)

#Load the package that contains the Cox Propotional Hazard Function
library(ggplot2)
library(tidyr)
library(dplyr)
library(Hmisc)
library(qqplotr)
library(ggthemes)
library(fabricatr)
library(gridExtra)
library(grid)
library(kableExtra)
library(sjPlot)
library(cowplot)
library(ggpubr)
library(patchwork)</code></pre>
<hr />
</div>
<div id="step-2-import-the-data" class="section level2">
<h2>Step 2: Import the data</h2>
<pre class="r"><code>#This imports the data from a CSV file and creates the data frame PrTC
Adult_Final&lt;-read.table(&quot;2021_Adult_Firefly_Survival_binned3.csv&quot;, header=TRUE, sep=&quot;,&quot;, dec=&quot;.&quot;,na.strings=&quot;.&quot;) 

#This sets up the color palette using tableau20: https://jrnold.github.io/ggthemes/reference/tableau_color_pal.html
site_colors &lt;- c(&quot;USA: Montour Co, Bucknell Natural Area&quot; = &quot;#4E79A7&quot;, 
                 &quot;USA: Union Co, Bucknell Farm&quot; = &quot;#F28E2B&quot;, 
                 &quot;USA: Union Co, Bucknell Ropes Course&quot; = &quot;#E15759&quot;)</code></pre>
<p><strong>Data Used:</strong></p>
<ul>
<li>838 fireflies with elytra length (calipers), body mass (analytical
balance), and survival data.</li>
</ul>
<p>Abbreviations used:</p>
<ul>
<li>BNA = Bucknell Natural Area</li>
<li>BUF = Bucknell University Farm</li>
<li>FDBCC = Forrest D. Brown Conference Center</li>
</ul>
<hr />
</div>
<div id="step-3-initial-analysis" class="section level2">
<h2>Step 3: Initial Analysis</h2>
<div id="elytron-length" class="section level3">
<h3><strong>Elytron length</strong></h3>
<div id="q1.-what-does-the-length-distribution-look-like-overall"
class="section level4">
<h4>Q1. What does the length distribution look like overall?</h4>
<ul>
<li><strong>Raw data</strong> (left) vs <strong>log-transformed</strong>
(right)</li>
</ul>
<pre class="r"><code>#generate distribution of raw data
z &lt;- ggplot(Adult_Final, aes(x=ElytralLength)) +
  geom_histogram() +
  xlab(&quot;Elytron length (mm)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5))

#generate log distribution plot
y &lt;- ggplot(Adult_Final, aes(x=log(ElytralLength))) +
  geom_histogram() +
  xlab(&quot;log(Elytron length) (mm)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5))

grid.arrange(z, y, nrow= 1)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20distributions-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="q2.-by-location" class="section level4">
<h4>Q2. …by location?</h4>
<ul>
<li>Data summary (untransformed):</li>
</ul>
<pre class="r"><code>#generate tibble
t&lt;- Adult_Final %&gt;% 
  group_by(Location) %&gt;% 
  summarise(N=n(), mean_length=round(mean(ElytralLength),2), SD = round(sd(ElytralLength), 2))

#generate nice looking table
kbl(t, col.names = c(&quot;Location&quot;, &quot;n&quot;, &quot;Mean elytron length (mm)&quot;, &quot;SD&quot;), align = &quot;lccc&quot;) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:center;">
Mean elytron length (mm)
</th>
<th style="text-align:center;">
SD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
298
</td>
<td style="text-align:center;">
9.11
</td>
<td style="text-align:center;">
0.96
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
8.90
</td>
<td style="text-align:center;">
1.08
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
470
</td>
<td style="text-align:center;">
8.94
</td>
<td style="text-align:center;">
0.95
</td>
</tr>
</tbody>
</table>
<ul>
<li>Raw data, three different ways:</li>
</ul>
<pre class="r"><code>#generate labels for sites that include sample size
site_labels = c(paste(&quot;BNA&quot;, &quot; (n = &quot;, t$N[1], &quot;)&quot;, sep=&quot;&quot;), 
                paste0(&quot;BUF&quot;, &quot; (n = &quot;, t$N[2], &quot;)&quot;), 
                paste0(&quot;FDBCC&quot;,  &quot; (n = &quot;, t$N[3], &quot;)&quot;))

#generate text placeholder
a &lt;- ggplot(Adult_Final, aes(x=ElytralLength, fill=Location)) +
  geom_histogram(alpha= 0.5, position=&quot;identity&quot;) +
  scale_fill_manual(name = &quot;Collection Location&quot;, labels = site_labels, values = site_colors)
  
legend.a &lt;- cowplot::get_legend(a)

#generate histogram
b &lt;- ggplot(Adult_Final, aes(x=ElytralLength, fill=Location)) +
  geom_histogram(alpha= 0.5, position=&quot;identity&quot;) +
  xlab(&quot;Elytron length (mm)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;) +
  scale_fill_manual(name = &quot;Location&quot;, labels = site_labels, values = site_colors)

#generate violin plot
c &lt;- ggplot(Adult_Final, aes(x=Location, y=ElytralLength, fill=Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x=element_blank(), axis.title.x=element_blank()) +
  geom_boxplot(width=0.2, alpha= 0.5, fill = &quot;white&quot;) +
  scale_fill_manual(values = site_colors)

#generate boxplot
d &lt;- ggplot(Adult_Final, aes(x=Location, y=ElytralLength, fill=Location)) +
  geom_boxplot(alpha = 0.9) +
  geom_jitter(size = 0.1)+
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x=element_blank(), axis.title.x=element_blank()) +
  scale_fill_manual(values = site_colors)

grid.arrange(legend.a,b,c,d, nrow=2)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20by%20site%20figures-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="q3.-by-seasonday" class="section level4">
<h4>Q3. …by seasonday</h4>
<ul>
<li>Data summary (untransformed):</li>
</ul>
<pre class="r"><code>#generate tibble
t &lt;- Adult_Final %&gt;%
  group_by(Location, SeasonDay) %&gt;%
  summarise(N=n(), mean_length=round(mean(ElytralLength),2), SD = round(sd(ElytralLength),2)) %&gt;%
  arrange(SeasonDay)

#make table nice in kable
kbl(t, col.names = c(&quot;Location&quot;, &quot;Season Day&quot;, &quot;n&quot;, &quot;Mean elytron length (mm)&quot;, &quot;SD&quot;), align = &quot;lcccc&quot;) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:center;">
Season Day
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:center;">
Mean elytron length (mm)
</th>
<th style="text-align:center;">
SD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
92
</td>
<td style="text-align:center;">
9.55
</td>
<td style="text-align:center;">
0.91
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
8.76
</td>
<td style="text-align:center;">
1.09
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
120
</td>
<td style="text-align:center;">
8.71
</td>
<td style="text-align:center;">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
231
</td>
<td style="text-align:center;">
8.96
</td>
<td style="text-align:center;">
0.94
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
86
</td>
<td style="text-align:center;">
9.21
</td>
<td style="text-align:center;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
95
</td>
<td style="text-align:center;">
8.93
</td>
<td style="text-align:center;">
1.01
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
9.21
</td>
<td style="text-align:center;">
1.01
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
90
</td>
<td style="text-align:center;">
8.94
</td>
<td style="text-align:center;">
0.93
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
54
</td>
<td style="text-align:center;">
8.90
</td>
<td style="text-align:center;">
0.97
</td>
</tr>
</tbody>
</table>
<ul>
<li>Raw data, three different ways:</li>
</ul>
<pre class="r"><code>#generate labels for seasondays that include sample size
t$SeasonDayLabel = paste(t$SeasonDay, &quot; (&quot;, t$N, &quot;)&quot;, sep =&quot;&quot;)
  
seasonday_label &lt;- c(
  &#39;9&#39; = t$SeasonDayLabel[1],
  &#39;13&#39; = t$SeasonDayLabel[2],
  &#39;15&#39; = t$SeasonDayLabel[3],
  &#39;17&#39; = t$SeasonDayLabel[4],
  &#39;22&#39; = t$SeasonDayLabel[5],
  &#39;23&#39; = t$SeasonDayLabel[6],
  &#39;30&#39; = t$SeasonDayLabel[7],
  &#39;31&#39; = t$SeasonDayLabel[8],
  &#39;36&#39; = t$SeasonDayLabel[9]
  )

#generate legend
e &lt;- ggplot(Adult_Final, aes(x=ElytralLength, fill=Location)) +
  geom_histogram() +
  xlab(&quot;Elytron length (mm)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~SeasonDay, labeller = as_labeller(seasonday_label)) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

legend.e &lt;- cowplot::get_legend(e)

#generate histogram
f &lt;- ggplot(Adult_Final, aes(x=log(ElytralLength), fill=Location)) +
  geom_histogram() +
  xlab(&quot;Elytron length (mm)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  ggtitle(&quot;SeasonDay (n)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;) +
  facet_wrap(~SeasonDay, labeller = as_labeller(seasonday_label), ncol=5) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

#generate violin plot by seasonday
g &lt;- ggplot(Adult_Final, aes(x=as.factor(SeasonDay), y=ElytralLength, fill = Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  geom_boxplot(width=0.2, fill = &quot;white&quot;) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

#generate violin plot by site
h &lt;- ggplot(Adult_Final, aes(x=as.factor(SeasonDay), y=ElytralLength, fill = Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x = element_text(angle = 90)) +
  facet_wrap(~Location, labeller = labeller(Location = 
    c(&quot;USA: Montour Co, Bucknell Natural Area&quot; = &quot;BNA&quot;,
      &quot;USA: Union Co, Bucknell Farm&quot; = &quot;BUF&quot;,
      &quot;USA: Union Co, Bucknell Ropes Course&quot; = &quot;FDBCC&quot;))) +
  geom_boxplot(width=0.2, fill = &quot;white&quot;) +
  scale_fill_manual(values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

lay1 &lt;- rbind(c(2,2,2,1))
lay2 &lt;- rbind(c(1,1,2,2,2))

g1 &lt;- arrangeGrob(legend.e, f, layout_matrix = lay1)
g2 &lt;- arrangeGrob(g,h, layout_matrix = lay2)
 
grid.arrange(g1, g2, nrow=2)                  </code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20by%20seasonday%20plots-1.png" style="display: block; margin: auto;" /></p>
</div>
<div
id="q4.-are-the-distributions-within-each-location-seasonday-normal"
class="section level4">
<h4>Q4. Are the distributions within each Location * SeasonDay
normal?</h4>
<p>Testing the <em>raw data:</em></p>
<ul>
<li><strong>Q-Q plot</strong> for the raw data (left) and
<strong>Shapiro test</strong> (bottom right)</li>
</ul>
<pre class="r"><code>#qq plots to assess normality
q &lt;- ggplot(Adult_Final, aes(sample=ElytralLength, color=Location)) +
  stat_qq_band(bandType = &quot;pointwise&quot;, fill = &quot;#8DA0CB&quot;, alpha = 0.4) + 
  stat_qq_line(color = &quot;#8DA0CB&quot;) +
  stat_qq_point() +
  ggtitle(&quot;Season Day&quot;) +
  facet_wrap(~SeasonDay) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) +
  theme(legend.position = &quot;none&quot;)

#statistically test
shapiro.table &lt;- NULL
for (day in levels(factor(Adult_Final$SeasonDay))){
  #subset table
  table.sub &lt;- Adult_Final[Adult_Final$SeasonDay == day,]
  test.result &lt;- (shapiro.test(table.sub$ElytralLength))
  info &lt;- data.frame(SeasonDay = day, W = round(test.result[1]$statistic, 2), p = round(test.result[2]$p.value, 2))
  shapiro.table &lt;- rbind(shapiro.table, info)
}

#create kable filename
kable_filename = paste(&quot;Elytron_length_shapiro&quot;, &quot;.png&quot;, sep=&quot;&quot;)

#generate nice table with kable
kbl(shapiro.table, row.names = FALSE, col.names = c(&quot;Season Day&quot;, &quot;W&quot;, &quot;P&quot;), align = &quot;ccc&quot;)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;) %&gt;% 
  save_kable(file = kable_filename, bs_theme = &quot;cerulean&quot;, zoom = 7) 

#make big plot with table
#read in kable table as image
r &lt;- ggdraw() +
  draw_image(kable_filename)

#stack the legend on top of the table
g3 &lt;- arrangeGrob(legend.e, r, nrow =2)

#make the column width layout
shapiro_layout &lt;- rbind(c(1,1,1,2))

#plot the graph next to the legend and table
grid.arrange(q, g3, nrow = 1,  layout_matrix = shapiro_layout)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20qq%20plots-1.png" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><em>p</em> &gt;&gt; 0.05 for elytron length distributions from each
collection day, and thus, cannot reject null (normality).</li>
</ul>
<p><em>This suggests that log transformation is not necessary to satisfy
statistical assumptions of a linear relationship between the response
variable (elytron length) and explanatory variables (season day,
location) when looking at how these variables are related. However, log
transformation is the standard when comparing body size metrics due to
allometric scaling expectations. Thus, we will proceed with testing
whether log transformation of elytron length alters expected linear
relationships among variables (specifically body mass and survival). The
fits may be no different or even better.</em></p>
</div>
<div id="q5.-does-log-transformation-change-things"
class="section level4">
<h4>Q5. Does log-transformation change things?</h4>
<p>Testing <strong>log-transformed data:</strong></p>
<ul>
<li><strong>Q-Q plot</strong> for the log-transformed data (left) and
<strong>Shapiro test</strong> (bottom right)</li>
</ul>
<pre class="r"><code>#qq plots to assess normality
q &lt;- ggplot(Adult_Final, aes(sample=log(ElytralLength), color=Location)) +
  stat_qq_band(bandType = &quot;pointwise&quot;, fill = &quot;#8DA0CB&quot;, alpha = 0.4) + 
  stat_qq_line(color = &quot;#8DA0CB&quot;) +
  stat_qq_point() +
  ggtitle(&quot;Season Day&quot;) +
  facet_wrap(~SeasonDay) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) +
  theme(legend.position = &quot;none&quot;)

#statistically test
shapiro.table &lt;- NULL
for (day in levels(factor(Adult_Final$SeasonDay))){
  #subset table
  table.sub &lt;- Adult_Final[Adult_Final$SeasonDay == day,]
  test.result &lt;- (shapiro.test(log(table.sub$ElytralLength)))
  info &lt;- data.frame(SeasonDay = day, W = round(test.result[1]$statistic, 2), p = round(test.result[2]$p.value, 2))
  shapiro.table &lt;- rbind(shapiro.table, info)
}

#create kable filename
kable_filename = paste(&quot;log_Elytron_length_shapiro&quot;, &quot;.png&quot;, sep=&quot;&quot;)

#generate nice table with kable
kbl(shapiro.table, row.names = FALSE, col.names = c(&quot;Season Day&quot;, &quot;W&quot;, &quot;P&quot;), align = &quot;ccc&quot;)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;) %&gt;% 
  save_kable(file = kable_filename, bs_theme = &quot;cerulean&quot;, zoom = 7) 

#make big plot with table
#read in kable table as image
r &lt;- ggdraw() +
  draw_image(kable_filename)

#stack the legend on top of the table
g3 &lt;- arrangeGrob(legend.e, r, nrow =2)

#make the column width layout
shapiro_layout &lt;- rbind(c(1,1,1,2))

#plot the graph next to the legend and table
grid.arrange(q, g3, nrow = 1,  layout_matrix = shapiro_layout)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log%20elytron%20length%20qq%20plots-1.png" style="display: block; margin: auto auto auto 0;" /></p>
<p><strong>Conclusions:</strong></p>
<ul>
<li><em>p</em> &lt; 0.05 for log elytron length distributions from one
collection day, and thus, reject normality. Two others (day 13 and day
23) are close (p = 0.08 and p = 0.06, respectively). Day 13 likely has
smaller sample size (BUF). Thus, most days are consistent with normal
distribution.</li>
<li>Since the distributions more frequently depart from normality, we
will use untransformed (raw) elytron length in analyses investigating
relationships with Season Day and Location, but will also investigate
the effects of log transformation in elytron length by body mass
comparisons. Perhaps transformation will not make a big difference. Most
sample sizes are &gt; 30, meaning they are large enough for parametric
tests anyway.</li>
</ul>
</div>
<div id="q6.-do-seasonday-and-location-predict-elytron-length"
class="section level4">
<h4>Q6. Do seasonday and location predict elytron length?</h4>
<ul>
<li>Summary of effects:</li>
</ul>
<pre class="r"><code>Elytral&lt;-lm(ElytralLength~SeasonDay*Location, data=Adult_Final)
summary(Elytral)</code></pre>
<pre><code>## 
## Call:
## lm(formula = ElytralLength ~ SeasonDay * Location, data = Adult_Final)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.98747 -0.62992  0.00396  0.64271  2.91253 
## 
## Coefficients:
##                                                        Estimate Std. Error t value
## (Intercept)                                             9.48258    0.17763  53.385
## SeasonDay                                              -0.02430    0.01112  -2.186
## LocationUSA: Union Co, Bucknell Farm                   -1.06859    0.34167  -3.128
## LocationUSA: Union Co, Bucknell Ropes Course           -0.48694    0.23421  -2.079
## SeasonDay:LocationUSA: Union Co, Bucknell Farm          0.05070    0.01821   2.784
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course  0.02206    0.01279   1.724
##                                                        Pr(&gt;|t|)    
## (Intercept)                                             &lt; 2e-16 ***
## SeasonDay                                               0.02910 *  
## LocationUSA: Union Co, Bucknell Farm                    0.00182 ** 
## LocationUSA: Union Co, Bucknell Ropes Course            0.03792 *  
## SeasonDay:LocationUSA: Union Co, Bucknell Farm          0.00550 ** 
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course  0.08505 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9639 on 832 degrees of freedom
## Multiple R-squared:  0.01736,    Adjusted R-squared:  0.01145 
## F-statistic:  2.94 on 5 and 832 DF,  p-value: 0.01223</code></pre>
<ul>
<li>ANOVA(model) results:</li>
</ul>
<pre class="r"><code>kbl(anova(Elytral), digits = 2)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SeasonDay
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
2.66
</td>
<td style="text-align:right;">
2.87
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:right;">
1.86
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
SeasonDay:Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7.28
</td>
<td style="text-align:right;">
3.64
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
832
</td>
<td style="text-align:right;">
773.03
</td>
<td style="text-align:right;">
0.93
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li>For <strong>Elytron length</strong>, only the interaction term
(<strong>SeasonDay:Location</strong>) is significant (p = 0.02).</li>
</ul>
</div>
<div id="conclusion" class="section level4">
<h4>Conclusion</h4>
<ul>
<li><p>Use log-transformed elytron length in downstream analysis when
using elytron length as an explanatory variable rather than a response
variable with respect to variation in body mass due to allometric
scaling.</p></li>
<li><p><strong>Season Day</strong> doesn’t really matter for elytron
length (this is expected if elytron length is fixed for the life of
adult).</p></li>
<li><p><strong>Location</strong> doesn’t really matter (caveats:
sampling efforts at sites were not equal and non-randomly distributed
across the season)</p></li>
<li><p><strong>SeasonDay:Location</strong> is significant. This is
apparent if you look at the violin plots for Season Day grouped by
Location. There is a downward trend in BNA, but not in the others.
However, the sample size (replicate sampling events at a particular site
across the season) is small (BNA = sampled 3 times in the first half of
the season, BUF = sampled twice, FDBCC = sampled 4 times, all in second
half of season).</p></li>
<li><p><strong>Side Note:</strong> Vencl and Carlson (1998) (<a
href="https://www.proquest.com/docview/757065622?accountid=9784"
class="uri">https://www.proquest.com/docview/757065622?accountid=9784</a>)
found a bimodal distribution in elytron length at their sites on Long
Island across season (July), no effect of year (3 field seasons) so
these were all pooled in the distribution displayed in the manuscript.
They log-transformed elytron length for their analysis, and the plot
displays the untransformed data.</p></li>
<li><p>Plots:</p>
<ul>
<li>Blue: BNA</li>
<li>Red: BUF</li>
<li>Gold: FDBCC</li>
</ul></li>
</ul>
<div id="overall-plot" class="section level5">
<h5>Overall plot</h5>
<pre class="r"><code>#plot with all locations over the season
p_elytral_length_by_season_day &lt;- ggplot(Adult_Final, aes(x=as.numeric(SeasonDay), y=ElytralLength, color = Location)) +
  geom_point(size = 1, alpha = 0.7) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

p_elytral_length_by_season_day</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20plot%20for%20interactions-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="investigating-individual-locations" class="section level5">
<h5>Investigating individual locations</h5>
<div id="bna" class="section level6">
<h6>BNA</h6>
<ul>
<li>Stats:</li>
</ul>
<pre class="r"><code>#BNA
Elytral_BNA&lt;-lm(ElytralLength~SeasonDay, data=Adult_Final[Adult_Final$Location == &quot;USA: Montour Co, Bucknell Natural Area&quot;,])
summary(Elytral_BNA)</code></pre>
<pre><code>## 
## Call:
## lm(formula = ElytralLength ~ SeasonDay, data = Adult_Final[Adult_Final$Location == 
##     &quot;USA: Montour Co, Bucknell Natural Area&quot;, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.79806 -0.62992  0.07903  0.66613  2.41613 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.4826     0.1758  53.937   &lt;2e-16 ***
## SeasonDay    -0.0243     0.0110  -2.209    0.028 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.954 on 296 degrees of freedom
## Multiple R-squared:  0.01621,    Adjusted R-squared:  0.01289 
## F-statistic: 4.878 on 1 and 296 DF,  p-value: 0.02797</code></pre>
<pre class="r"><code>p_elytral_length_by_season_day_BNA &lt;- ggplot(Adult_Final[Adult_Final$Location == &quot;USA: Montour Co, Bucknell Natural Area&quot;,], aes(x=as.numeric(SeasonDay), y=ElytralLength)) +
  geom_point(size = 1, alpha = 0.7, color = &quot;#4E79A7&quot;) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  geom_smooth(method = &quot;lm&quot;, se=FALSE, color = &quot;gray23&quot;) +
  stat_regline_equation(label.x = 17, label.y = 11.4, aes(label = ..eq.label..)) +
  stat_regline_equation(label.x = 17, label.y = 11.0, aes(label = ..rr.label..)) +
  ggtitle(&quot;BNA&quot;)

#p_elytral_length_by_season_day_BNA</code></pre>
</div>
<div id="buf" class="section level6">
<h6>BUF</h6>
<ul>
<li>Stats:</li>
</ul>
<pre class="r"><code>Elytral_BUF&lt;-lm(ElytralLength~SeasonDay, data=Adult_Final[Adult_Final$Location == &quot;USA: Union Co, Bucknell Farm&quot;,])
summary(Elytral_BUF)</code></pre>
<pre><code>## 
## Call:
## lm(formula = ElytralLength ~ SeasonDay, data = Adult_Final[Adult_Final$Location == 
##     &quot;USA: Union Co, Bucknell Farm&quot;, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.27723 -0.61695  0.02277  0.75613  2.02277 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.41399    0.32250  26.090   &lt;2e-16 ***
## SeasonDay    0.02640    0.01594   1.656    0.102    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.065 on 68 degrees of freedom
## Multiple R-squared:  0.03877,    Adjusted R-squared:  0.02463 
## F-statistic: 2.743 on 1 and 68 DF,  p-value: 0.1023</code></pre>
<pre class="r"><code>p_elytral_length_by_season_day_BUF &lt;- ggplot(Adult_Final[Adult_Final$Location == &quot;USA: Union Co, Bucknell Farm&quot;,], aes(x=as.numeric(SeasonDay), y=ElytralLength)) +
  geom_point(size = 1, alpha = 0.7, color = &quot;#F28E2B&quot;) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  ggtitle(&quot;BUF&quot;)

#p_log_elytral_length_by_season_day_BUF</code></pre>
</div>
<div id="fdbcc" class="section level6">
<h6>FDBCC</h6>
<ul>
<li>Stats:</li>
</ul>
<pre class="r"><code>Elytral_FDBCC&lt;-lm(ElytralLength~SeasonDay, data=Adult_Final[Adult_Final$Location == &quot;USA: Union Co, Bucknell Ropes Course&quot;,])
summary(Elytral_FDBCC)</code></pre>
<pre><code>## 
## Call:
## lm(formula = ElytralLength ~ SeasonDay, data = Adult_Final[Adult_Final$Location == 
##     &quot;USA: Union Co, Bucknell Ropes Course&quot;, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.98747 -0.63048 -0.03074  0.62789  2.91253 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.995642   0.151183  59.502   &lt;2e-16 ***
## SeasonDay   -0.002245   0.006267  -0.358     0.72    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9546 on 468 degrees of freedom
## Multiple R-squared:  0.0002742,  Adjusted R-squared:  -0.001862 
## F-statistic: 0.1283 on 1 and 468 DF,  p-value: 0.7203</code></pre>
<pre class="r"><code>p_elytral_length_by_season_day_FDBCC &lt;- ggplot(Adult_Final[Adult_Final$Location == &quot;USA: Union Co, Bucknell Ropes Course&quot;,], aes(x=as.numeric(SeasonDay), y=ElytralLength)) +
  geom_point(size = 1, alpha = 0.7, color = &quot;#E15759&quot;) +
  theme_classic() +
  ylab(&quot;Elytron length (mm)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;)  +
  ggtitle(&quot;FDBCC&quot;)

#p_log_elytral_length_by_season_day_FDBCC</code></pre>
</div>
<div id="plots" class="section level6">
<h6>Plots</h6>
<pre class="r"><code>p_elytral_length_by_season_day_BNA + p_elytral_length_by_season_day_BUF + p_elytral_length_by_season_day_FDBCC</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/elytron%20length%20by%20location%20over%20the%20season%20plots-1.png" style="display: block; margin: auto;" /></p>
<p><strong>Conclusions:</strong></p>
<ul>
<li>elytron length decreases over the season at BNA (p = 0.03), with 3
sampling days</li>
<li>doesn’t have an effect at BUF (p = 0.1), but only 2 sampling
days</li>
<li>doesn’t have an effect at FDBCC (p = 0.7), with 4 sampling days</li>
<li>additional replicated sampling days at each site, preferably
distributed across the season, are required to further investigate this
trend</li>
</ul>
</div>
</div>
</div>
</div>
<div id="body-mass" class="section level3">
<h3><strong>Body mass</strong></h3>
<div id="q1.-what-does-the-mass-distribution-look-like-overall"
class="section level4">
<h4>Q1. What does the mass distribution look like overall?</h4>
<ul>
<li><strong>Raw data</strong> (left) vs <strong>log-transformed</strong>
(right)</li>
</ul>
<pre class="r"><code>#generate distribution of raw data
z &lt;- ggplot(Adult_Final, aes(x=Mass)) +
  geom_histogram() +
  xlab(&quot;Body mass (g)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5))

#generate log distribution plot
y &lt;- ggplot(Adult_Final, aes(x=log(Mass))) +
  geom_histogram() +
  xlab(&quot;log(Body mass) (g)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5))

grid.arrange(z, y, nrow= 1)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/body%20mass%20distributions-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="q2.-by-location-1" class="section level4">
<h4>Q2. …by location?</h4>
<ul>
<li>Data summary (untransformed):</li>
</ul>
<pre class="r"><code>#generate tibble 
t&lt;- Adult_Final %&gt;% 
  group_by(Location) %&gt;% 
  summarise(N=n(), mean_mass=round(mean(Mass),4), SD = round(sd(Mass), 4))

#generate nice looking table
kbl(t, col.names = c(&quot;Location&quot;, &quot;n&quot;, &quot;Mean body mass (g)&quot;, &quot;SD&quot;), align = &quot;lccc&quot;) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:center;">
Mean body mass (g)
</th>
<th style="text-align:center;">
SD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
298
</td>
<td style="text-align:center;">
0.0323
</td>
<td style="text-align:center;">
0.0092
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
0.0326
</td>
<td style="text-align:center;">
0.0088
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
470
</td>
<td style="text-align:center;">
0.0312
</td>
<td style="text-align:center;">
0.0083
</td>
</tr>
</tbody>
</table>
<ul>
<li>Log-transformed data, three different ways:</li>
</ul>
<pre class="r"><code>#generate sample size labels
site_labels = c(paste(&quot;BNA&quot;, &quot; (N=&quot;, t$N[1], &quot;)&quot;, sep=&quot;&quot;), 
                paste0(&quot;BUF&quot;, &quot; (N=&quot;, t$N[2], &quot;)&quot;), 
                paste0(&quot;FDBCC&quot;,  &quot; (N=&quot;, t$N[3], &quot;)&quot;))

#generate text placeholder
i &lt;- ggplot(Adult_Final, aes(x=log(Mass), fill=Location)) +
  geom_histogram(alpha= 0.5, position=&quot;identity&quot;) +
  scale_fill_manual(name = &quot;Collection Location&quot;, labels = site_labels, values = site_colors)
  
legend.i &lt;- cowplot::get_legend(i)

#generate histogram with log mass
j &lt;- ggplot(Adult_Final, aes(x=log(Mass), fill=Location)) +
  geom_histogram(alpha= 0.5, position=&quot;identity&quot;) +
  xlab(&quot;log(Body mass) (g)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;) +
  scale_fill_manual(name = &quot;Location&quot;, labels = site_labels, values = site_colors)

#generate violin plot with log mass
k &lt;- ggplot(Adult_Final, aes(x=Location, y=log(Mass), fill=Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;log(Body mass) (g)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x=element_blank(), axis.title.x=element_blank()) +
  geom_boxplot(width=0.2, alpha= 0.5, fill = &quot;white&quot;) +
  scale_fill_manual(values = site_colors)

#generate boxplot
l &lt;- ggplot(Adult_Final, aes(x=Location, y=log(Mass), fill=Location)) +
  geom_boxplot(alpha = 0.9) +
  geom_jitter(size = 0.1)+
  theme_classic() +
  ylab(&quot;log(Body mass) (g)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x=element_blank(), axis.title.x=element_blank()) +
  scale_fill_manual(values = site_colors)

grid.arrange(legend.i,j,k,l, nrow=2)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log(body%20mass)%20by%20location%20plots-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="q3.-by-seasonday-1" class="section level4">
<h4>Q3. …by seasonday</h4>
<ul>
<li>Data summary (untransformed):</li>
</ul>
<pre class="r"><code>#generate tibble
t &lt;- Adult_Final %&gt;%
  group_by(Location, SeasonDay) %&gt;%
  summarise(N=n(), mean_mass=round(mean(Mass),4), SD = round(sd(Mass),4)) %&gt;%
  arrange(SeasonDay)

#make table nice in kable
kbl(t, col.names = c(&quot;Location&quot;, &quot;Season Day&quot;, &quot;n&quot;, &quot;Mean body mass (g)&quot;, &quot;SD&quot;), align = &quot;lcccc&quot;) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Location
</th>
<th style="text-align:center;">
Season Day
</th>
<th style="text-align:center;">
n
</th>
<th style="text-align:center;">
Mean body mass (g)
</th>
<th style="text-align:center;">
SD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
92
</td>
<td style="text-align:center;">
0.0337
</td>
<td style="text-align:center;">
0.0092
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
0.0325
</td>
<td style="text-align:center;">
0.0095
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
120
</td>
<td style="text-align:center;">
0.0313
</td>
<td style="text-align:center;">
0.0099
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
231
</td>
<td style="text-align:center;">
0.0321
</td>
<td style="text-align:center;">
0.0087
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Montour Co, Bucknell Natural Area
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
86
</td>
<td style="text-align:center;">
0.0320
</td>
<td style="text-align:center;">
0.0081
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
95
</td>
<td style="text-align:center;">
0.0312
</td>
<td style="text-align:center;">
0.0088
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Farm
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0.0330
</td>
<td style="text-align:center;">
0.0074
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
90
</td>
<td style="text-align:center;">
0.0292
</td>
<td style="text-align:center;">
0.0071
</td>
</tr>
<tr>
<td style="text-align:left;">
USA: Union Co, Bucknell Ropes Course
</td>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
54
</td>
<td style="text-align:center;">
0.0306
</td>
<td style="text-align:center;">
0.0072
</td>
</tr>
</tbody>
</table>
<ul>
<li>Log-transformed data, three different ways:</li>
</ul>
<pre class="r"><code>#generate labels for seasondays that include sample size
t$SeasonDayLabel = paste(t$SeasonDay, &quot; (&quot;, t$N, &quot;)&quot;, sep =&quot;&quot;)

seasonday_label &lt;- c(
  &#39;9&#39; = t$SeasonDayLabel[1],
  &#39;13&#39; = t$SeasonDayLabel[2],
  &#39;15&#39; = t$SeasonDayLabel[3],
  &#39;17&#39; = t$SeasonDayLabel[4],
  &#39;22&#39; = t$SeasonDayLabel[5],
  &#39;23&#39; = t$SeasonDayLabel[6],
  &#39;30&#39; = t$SeasonDayLabel[7],
  &#39;31&#39; = t$SeasonDayLabel[8],
  &#39;36&#39; = t$SeasonDayLabel[9]
  )

#generate histogram
m &lt;- ggplot(Adult_Final, aes(x=log(Mass), fill=Location)) +
  geom_histogram() +
  xlab(&quot;log(Body mass) (g)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  theme(plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~SeasonDay, labeller = as_labeller(seasonday_label)) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) 

#generate legend
legend.m &lt;- cowplot::get_legend(m)

#generate histogram
n &lt;- ggplot(Adult_Final, aes(x=log(Mass), fill=Location)) +
  geom_histogram() +
  xlab(&quot;log(Body mass) (g)&quot;) +
  ylab(&quot;N fireflies&quot;) +
  ggtitle(&quot;Season Day (n)&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;) +
  facet_wrap(~SeasonDay, labeller = as_labeller(seasonday_label), ncol = 5) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) 

#generate violin plot by seasonday
o &lt;- ggplot(Adult_Final, aes(x=as.factor(SeasonDay), y=log(Mass), fill = Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;log(Body mass) (g)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  geom_boxplot(width=0.2, fill = &quot;white&quot;) +
  scale_fill_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

#generate violin plot by site
p &lt;- ggplot(Adult_Final, aes(x=as.factor(SeasonDay), y=log(Mass), fill = Location)) +
  geom_violin(alpha = 0.9) +
  theme_classic() +
  ylab(&quot;log(Body mass) (g)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), legend.position = &quot;none&quot;, axis.text.x = element_text(angle = 90)) +
  facet_wrap(~Location, labeller = labeller(Location = 
    c(&quot;USA: Montour Co, Bucknell Natural Area&quot; = &quot;BNA&quot;,
      &quot;USA: Union Co, Bucknell Farm&quot; = &quot;BUF&quot;,
      &quot;USA: Union Co, Bucknell Ropes Course&quot; = &quot;FDBCC&quot;))) +
  geom_boxplot(width=0.2, fill = &quot;white&quot;) +
  scale_fill_manual(values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;))

lay1 &lt;- rbind(c(2,2,2,1))
lay2 &lt;- rbind(c(1,1,2,2,2))

g3 &lt;- arrangeGrob(legend.m, n, layout_matrix = lay1)
g4 &lt;- arrangeGrob(o,p, layout_matrix = lay2)
 
grid.arrange(g3, g4, nrow=2)   </code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log%20body%20mass%20by%20seasonday%20plots-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="q4.-are-the-distributions-within-each-site-seasonday-normal"
class="section level4">
<h4>Q4. Are the distributions within each Site * SeasonDay normal?</h4>
<p>Testing the <strong>raw data:</strong></p>
<ul>
<li><strong>Q-Q plots</strong> for the raw data (left) and
<strong>Shapiro test</strong> (bottom right)</li>
</ul>
<pre class="r"><code>#qq plots to assess normality with raw data
q &lt;- ggplot(Adult_Final, aes(sample=Mass, color=Location)) +
  stat_qq_band(bandType = &quot;pointwise&quot;, fill = &quot;#8DA0CB&quot;, alpha = 0.4) + 
  stat_qq_line(color = &quot;#8DA0CB&quot;) +
  stat_qq_point() +
  facet_wrap(~SeasonDay) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) +
  theme(legend.position = &quot;none&quot;)

#statistically test
shapiro.table &lt;- NULL
for (day in levels(factor(Adult_Final$SeasonDay))){
  #subset table
  table.sub &lt;- Adult_Final[Adult_Final$SeasonDay == day,]
  test.result &lt;- (shapiro.test(table.sub$Mass))
  info &lt;- data.frame(SeasonDay = day, W = round(test.result[1]$statistic, 2), p = round(test.result[2]$p.value, 2))
  shapiro.table &lt;- rbind(shapiro.table, info)
}

#generate kable filename
kable_filename = paste(&quot;Body_mass_raw_shapiro&quot;, &quot;.png&quot;, sep=&quot;&quot;)

#generate nice table with kable
kbl(shapiro.table, row.names = FALSE, col.names = c(&quot;Season Day&quot;, &quot;W&quot;, &quot;P&quot;), align = &quot;ccc&quot;)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;) %&gt;%
  save_kable(file = kable_filename, bs_theme = &quot;cerulean&quot;, zoom = 7)

#read in kable table as image
r &lt;- ggdraw() +
  draw_image(kable_filename)

#stack the legend on top of the table
g3 &lt;- arrangeGrob(legend.e, r, nrow =2)

#make the column width layout
shapiro_layout &lt;- rbind(c(1,1,1,2))

#plot the graph next to the legend and table
grid.arrange(q, g3, nrow = 1,  layout_matrix = shapiro_layout)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/raw%20body%20mass%20qq%20plots-1.png" style="display: block; margin: auto;" /></p>
<p><strong>Conclusions:</strong> Not normal (5/9 days):</p>
<ul>
<li>Day 13</li>
<li>Day 15</li>
<li>Day 17</li>
<li>Day 23</li>
<li>Day 31</li>
</ul>
<p><em>However, sample size is large on these days - only Day 30 (not
included in list of collections that violate normality) has sample size
&lt; 30. Next, test log-transformed data to see if improves.</em></p>
</div>
<div id="q5.-does-log-transformation-help" class="section level4">
<h4>Q5. Does log-transformation help?</h4>
<p><em>Note: Log-transformation of body mass is necessary for the
assumption of linearity in survival models (see Methods in main
text)</em></p>
<p>Testing <strong>log-transformed data:</strong></p>
<ul>
<li><strong>Q-Q plots</strong> for the log-transformed data (left) and
<strong>Shapiro test</strong> (bottom right)</li>
</ul>
<pre class="r"><code>#qq plots to assess normality
q &lt;- ggplot(Adult_Final, aes(sample=log(Mass), color=Location)) +
  stat_qq_band(bandType = &quot;pointwise&quot;, fill = &quot;#8DA0CB&quot;, alpha = 0.4) + 
  stat_qq_line(color = &quot;#8DA0CB&quot;) +
  stat_qq_point() +
  facet_wrap(~SeasonDay) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) +
  theme(legend.position = &quot;none&quot;)

#statistically test
shapiro.table &lt;- NULL
for (day in levels(factor(Adult_Final$SeasonDay))){
  #subset table
  table.sub &lt;- Adult_Final[Adult_Final$SeasonDay == day,]
  test.result &lt;- (shapiro.test(log(table.sub$Mass)))
  info &lt;- data.frame(SeasonDay = day, W = round(test.result[1]$statistic, 2), p = round(test.result[2]$p.value, 2))
  shapiro.table &lt;- rbind(shapiro.table, info)
}

#generate kable table filename
kable_filename = paste(&quot;Body_mass_log_shapiro&quot;, &quot;.png&quot;, sep=&quot;&quot;)
  
#generate nice table with kable
kbl(shapiro.table, row.names = FALSE, col.names = c(&quot;Season Day&quot;, &quot;W&quot;, &quot;P&quot;), align = &quot;ccc&quot;)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;) %&gt;%
  save_kable(file = kable_filename, bs_theme = &quot;cerulean&quot;, zoom = 7)

#read in kable table as image
r &lt;- ggdraw() +
  draw_image(kable_filename)

#stack the legend on top of the table
g3 &lt;- arrangeGrob(legend.e, r, nrow =2)

#make the column width layout
shapiro_layout &lt;- rbind(c(1,1,1,2))

#plot the graph next to the legend and table
grid.arrange(q, g3, nrow = 1,  layout_matrix = shapiro_layout)</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log%20body%20mass%20qq%20plots-1.png" style="display: block; margin: auto;" /></p>
<p><strong>Conclusions:</strong></p>
<ul>
<li>Yes - <em>P</em> &gt;&gt; 0.05 for log body mass distributions from
each collection day, fail to reject normality.</li>
</ul>
</div>
<div id="q6.-do-seasonday-and-location-predict-body-mass"
class="section level4">
<h4>Q6. Do seasonday and location predict body mass?</h4>
<ul>
<li>Summary of effects:</li>
</ul>
<pre class="r"><code>#no Elytral length; + interaction
Mass&lt;-lm(log(Mass)~SeasonDay*Location, data=Adult_Final)
summary(Mass)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(Mass) ~ SeasonDay * Location, data = Adult_Final)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.74613 -0.18636  0.00805  0.18811  0.72058 
## 
## Coefficients:
##                                                          Estimate Std. Error t value
## (Intercept)                                            -3.4227082  0.0501670 -68.226
## SeasonDay                                              -0.0034295  0.0031398  -1.092
## LocationUSA: Union Co, Bucknell Farm                   -0.0684593  0.0964965  -0.709
## LocationUSA: Union Co, Bucknell Ropes Course            0.0129793  0.0661484   0.196
## SeasonDay:LocationUSA: Union Co, Bucknell Farm          0.0052895  0.0051443   1.028
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course -0.0005526  0.0036129  -0.153
##                                                        Pr(&gt;|t|)    
## (Intercept)                                              &lt;2e-16 ***
## SeasonDay                                                 0.275    
## LocationUSA: Union Co, Bucknell Farm                      0.478    
## LocationUSA: Union Co, Bucknell Ropes Course              0.844    
## SeasonDay:LocationUSA: Union Co, Bucknell Farm            0.304    
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course    0.878    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2722 on 832 degrees of freedom
## Multiple R-squared:  0.01091,    Adjusted R-squared:  0.00497 
## F-statistic: 1.836 on 5 and 832 DF,  p-value: 0.1033</code></pre>
<ul>
<li>ANOVA(model) results:</li>
</ul>
<pre class="r"><code>#anova(Mass) #interaction term NS, SeasonDay p = 0.008244

#display results as nice table with kable
kbl(anova(Mass), digits = 2)  %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SeasonDay
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
6.66
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.67
</td>
</tr>
<tr>
<td style="text-align:left;">
SeasonDay:Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.87
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
832
</td>
<td style="text-align:right;">
61.66
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>SeasonDay</strong> is significant (p = 0.01)</li>
</ul>
</div>
<div id="conclusion-1" class="section level4">
<h4>Conclusion</h4>
<ul>
<li><p>Use log-transformed mass in downstream analysis</p></li>
<li><p>Mass decreases over the <strong>season</strong> (potentially
reflects using up energy reserves, desiccation).</p></li>
<li><p>Plot for multi-panel figure</p></li>
</ul>
<pre class="r"><code>p_body_mass_by_season_day &lt;- ggplot(Adult_Final, aes(x=as.numeric(SeasonDay), y=log(Mass))) +
  geom_point(aes(color = Location), size = 1, alpha = 0.7) +
  geom_smooth(method = &quot;lm&quot;, se=FALSE, color = &quot;gray23&quot;) +
  theme_classic() +
  ylab(&quot;log(Body mass) (g)&quot;) +
  xlab(&quot;Season Day&quot;) +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 90), legend.position = &quot;none&quot;) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) + stat_regline_equation(label.x = 23, label.y = -2.8, aes(label = ..eq.label..)) +
  stat_regline_equation(label.x = 23, label.y = -2.6, aes(label = ..rr.label..))

p_body_mass_by_season_day</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log%20body%20mass%20plot%20for%20multi-panel%20fig%20for%20main%20text-1.png" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="length-mass" class="section level3">
<h3><strong>Length &amp; Mass</strong></h3>
<div
id="q1.-accounting-for-allometry-log-log-does-elytron-length-predict-body-mass"
class="section level4">
<h4>Q1. Accounting for allometry (log-log), does elytron length predict
body mass?</h4>
<ul>
<li>Summary</li>
</ul>
<pre class="r"><code>Both&lt;-lm(log(Mass)~log(ElytralLength), data=Adult_Final)
summary(Both)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(Mass) ~ log(ElytralLength), data = Adult_Final)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.86176 -0.13766  0.00558  0.13144  0.66330 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        -7.28523    0.13514  -53.91   &lt;2e-16 ***
## log(ElytralLength)  1.73265    0.06159   28.13   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1957 on 836 degrees of freedom
## Multiple R-squared:  0.4863, Adjusted R-squared:  0.4857 
## F-statistic: 791.4 on 1 and 836 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>ANOVA</li>
</ul>
<pre class="r"><code>kbl(anova(Both), row.names = TRUE, digits = 130) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
log(ElytralLength)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30.31656
</td>
<td style="text-align:right;">
30.31656157
</td>
<td style="text-align:right;">
791.4157
</td>
<td style="text-align:right;">
4.705031e-123
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
836
</td>
<td style="text-align:right;">
32.02444
</td>
<td style="text-align:right;">
0.03830675
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<ul>
<li>Plot</li>
</ul>
<pre class="r"><code>#using ggpubr package to get equations on graphs
#SOURCE: https://www.roelpeters.be/how-to-add-a-regression-equation-and-r-squared-in-ggplot2/
p_body_mass_by_elytron_length &lt;- ggplot(Adult_Final,aes(x = log(ElytralLength), y = log(Mass))) + 
  geom_point(data = Adult_Final, aes(color = Location), size = 1, alpha = 0.7) + 
  geom_smooth(method = &quot;lm&quot;, se=FALSE, color = &quot;gray23&quot;) +
  theme_classic() + 
  stat_regline_equation(label.y = -2.75, aes(label = ..eq.label..)) +
  stat_regline_equation(label.y = -2.87, aes(label = ..rr.label..)) +
  scale_color_manual(name = &quot;Location&quot;, labels = c(&quot;BNA&quot;, &quot;BUF&quot;, &quot;FDBCC&quot;), values = c(&quot;#4E79A7&quot;, &quot;#F28E2B&quot;, &quot;#E15759&quot;)) +
  theme(legend.position = &quot;none&quot;) +
  ylab(&quot;log(Body mass) (g)&quot;) +
  xlab(&quot;log(Elytron length) (mm)&quot;)

p_body_mass_by_elytron_length</code></pre>
<p><img
src="S1.EL_Mass_relationships_6_14_22_files/figure-html/log(length)%20vs%20log(mass)%20plot-1.png" /><!-- --></p>
</div>
<div
id="q2.-if-account-for-logelytron-length-first-in-the-model-do-season-day-andor-location-predict-body-mass"
class="section level4">
<h4>Q2. If account for log(elytron length) first in the model, do Season
Day and/or Location predict body mass?</h4>
<ul>
<li>Summary of effects:</li>
</ul>
<pre class="r"><code>#including interaction, but restricting to 2nd order interactions due to small sample size
Mass&lt;-lm(log(Mass)~log(ElytralLength)*SeasonDay*Location, data=Adult_Final)
summary(Mass)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(Mass) ~ log(ElytralLength) * SeasonDay * Location, 
##     data = Adult_Final)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.81332 -0.13162  0.00501  0.12579  0.65748 
## 
## Coefficients:
##                                                                            Estimate
## (Intercept)                                                               -7.231751
## log(ElytralLength)                                                         1.698810
## SeasonDay                                                                 -0.032489
## LocationUSA: Union Co, Bucknell Farm                                       1.997806
## LocationUSA: Union Co, Bucknell Ropes Course                              -1.037070
## log(ElytralLength):SeasonDay                                               0.015145
## log(ElytralLength):LocationUSA: Union Co, Bucknell Farm                   -0.866447
## log(ElytralLength):LocationUSA: Union Co, Bucknell Ropes Course            0.520282
## SeasonDay:LocationUSA: Union Co, Bucknell Farm                            -0.013209
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course                     0.073983
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Farm          0.004831
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course -0.035764
##                                                                           Std. Error
## (Intercept)                                                                 0.848913
## log(ElytralLength)                                                          0.379069
## SeasonDay                                                                   0.056310
## LocationUSA: Union Co, Bucknell Farm                                        1.350131
## LocationUSA: Union Co, Bucknell Ropes Course                                1.054078
## log(ElytralLength):SeasonDay                                                0.025214
## log(ElytralLength):LocationUSA: Union Co, Bucknell Farm                     0.612366
## log(ElytralLength):LocationUSA: Union Co, Bucknell Ropes Course             0.474623
## SeasonDay:LocationUSA: Union Co, Bucknell Farm                              0.078929
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course                      0.061974
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Farm           0.035582
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course   0.027855
##                                                                           t value
## (Intercept)                                                                -8.519
## log(ElytralLength)                                                          4.482
## SeasonDay                                                                  -0.577
## LocationUSA: Union Co, Bucknell Farm                                        1.480
## LocationUSA: Union Co, Bucknell Ropes Course                               -0.984
## log(ElytralLength):SeasonDay                                                0.601
## log(ElytralLength):LocationUSA: Union Co, Bucknell Farm                    -1.415
## log(ElytralLength):LocationUSA: Union Co, Bucknell Ropes Course             1.096
## SeasonDay:LocationUSA: Union Co, Bucknell Farm                             -0.167
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course                      1.194
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Farm           0.136
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course  -1.284
##                                                                           Pr(&gt;|t|)    
## (Intercept)                                                                &lt; 2e-16 ***
## log(ElytralLength)                                                        8.46e-06 ***
## SeasonDay                                                                    0.564    
## LocationUSA: Union Co, Bucknell Farm                                         0.139    
## LocationUSA: Union Co, Bucknell Ropes Course                                 0.325    
## log(ElytralLength):SeasonDay                                                 0.548    
## log(ElytralLength):LocationUSA: Union Co, Bucknell Farm                      0.157    
## log(ElytralLength):LocationUSA: Union Co, Bucknell Ropes Course              0.273    
## SeasonDay:LocationUSA: Union Co, Bucknell Farm                               0.867    
## SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course                       0.233    
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Farm            0.892    
## log(ElytralLength):SeasonDay:LocationUSA: Union Co, Bucknell Ropes Course    0.200    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1933 on 826 degrees of freedom
## Multiple R-squared:  0.5048, Adjusted R-squared:  0.4982 
## F-statistic: 76.53 on 11 and 826 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>ANOVA:</li>
</ul>
<pre class="r"><code>kbl(anova(Mass), row.names = TRUE, digits = 130) %&gt;%
  kable_classic(full_width = F, html_font = &quot;Cambria&quot;)</code></pre>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
log(ElytralLength)
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30.31656157
</td>
<td style="text-align:right;">
30.31656157
</td>
<td style="text-align:right;">
811.0826030
</td>
<td style="text-align:right;">
7.886660e-125
</td>
</tr>
<tr>
<td style="text-align:left;">
SeasonDay
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.16518932
</td>
<td style="text-align:right;">
0.16518932
</td>
<td style="text-align:right;">
4.4194385
</td>
<td style="text-align:right;">
3.583390e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.29247175
</td>
<td style="text-align:right;">
0.14623587
</td>
<td style="text-align:right;">
3.9123623
</td>
<td style="text-align:right;">
2.036480e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
log(ElytralLength):SeasonDay
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.02514312
</td>
<td style="text-align:right;">
0.02514312
</td>
<td style="text-align:right;">
0.6726735
</td>
<td style="text-align:right;">
4.123577e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
log(ElytralLength):Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.39495934
</td>
<td style="text-align:right;">
0.19747967
</td>
<td style="text-align:right;">
5.2833276
</td>
<td style="text-align:right;">
5.248466e-03
</td>
</tr>
<tr>
<td style="text-align:left;">
SeasonDay:Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.15246708
</td>
<td style="text-align:right;">
0.07623354
</td>
<td style="text-align:right;">
2.0395354
</td>
<td style="text-align:right;">
1.307438e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
log(ElytralLength):SeasonDay:Location
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.12006939
</td>
<td style="text-align:right;">
0.06003470
</td>
<td style="text-align:right;">
1.6061550
</td>
<td style="text-align:right;">
2.012837e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
826
</td>
<td style="text-align:right;">
30.87414249
</td>
<td style="text-align:right;">
0.03737790
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusions" class="section level4">
<h4>Conclusions</h4>
<ul>
<li><p><strong>log(Elytron length)</strong> sig. correlated with
<strong>body mass</strong>, but can’t explain everything (v small p, r^2
= 0.49)</p></li>
<li><p><strong>Location</strong> and <strong>SeasonDay</strong>
significant when <strong>elytra length</strong> accounted for</p></li>
<li><p>Question: take residuals as “adult reserves” measurement?</p>
<ul>
<li>no -&gt; see Darlington, R. B., and T. V. Smulders. 2001. Problems
with residual analysis. Anim. Behav. 62:599–602.</li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="combined-multi-plot-visualizing-main-results"
class="section level3">
<h3>Combined multi-plot visualizing main results</h3>
<pre class="r"><code>#using patchwork
#get the plots together
multiplot &lt;- p_elytral_length_by_season_day_BNA + p_elytral_length_by_season_day_BUF + p_elytral_length_by_season_day_FDBCC + p_body_mass_by_season_day + p_body_mass_by_elytron_length

#add annotations and layouts
w &lt;- multiplot + plot_annotation(tag_levels = &#39;A&#39;) + plot_layout(widths = unit(c(3),c(&quot;in&quot;)), heights = unit(c(2), c(&quot;in&quot;)), guides = &quot;collect&quot;) &amp; theme(legend.position = &#39;bottom&#39;)

w</code></pre>
<p><img src="S1.EL_Mass_relationships_6_14_22_files/figure-html/combined%20plot%20for%20initial%20analysis-1.png" style="display: block; margin: auto;" /></p>
<pre class="r"><code>#ggsave(&quot;FigS1.EL_Mass_analysis.png&quot;, w, width = 12, height = 8, device = &quot;png&quot;)</code></pre>
<hr />
</div>
</div>
<div id="step-4-session-info" class="section level2">
<h2>Step 4: Session Info</h2>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.2.1 (2022-06-23)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] patchwork_1.1.2  ggpubr_0.4.0     cowplot_1.1.1    sjPlot_2.8.11   
##  [5] kableExtra_1.3.4 gridExtra_2.3    fabricatr_1.0.0  ggthemes_4.2.4  
##  [9] qqplotr_0.0.5    Hmisc_4.7-1      Formula_1.2-4    survival_3.4-0  
## [13] lattice_0.20-45  dplyr_1.0.10     tidyr_1.2.1      ggplot2_3.3.6   
## 
## loaded via a namespace (and not attached):
##   [1] minqa_1.2.4         colorspace_2.0-3    ggsignif_0.6.3      deldir_1.0-6       
##   [5] ellipsis_0.3.2      sjlabelled_1.2.0    estimability_1.4.1  htmlTable_2.4.1    
##   [9] parameters_0.18.2   base64enc_0.1-3     rstudioapi_0.14     farver_2.1.1       
##  [13] fansi_1.0.3         mvtnorm_1.1-3       xml2_1.3.3          splines_4.2.1      
##  [17] cachem_1.0.6        robustbase_0.95-0   knitr_1.40          sjmisc_2.8.9       
##  [21] polynom_1.4-1       jsonlite_1.8.0      nloptr_2.0.3        ggeffects_1.1.3    
##  [25] broom_1.0.1         cluster_2.1.4       png_0.1-7           effectsize_0.7.0.5 
##  [29] compiler_4.2.1      httr_1.4.4          sjstats_0.18.1      emmeans_1.8.1-1    
##  [33] backports_1.4.1     Matrix_1.5-1        fastmap_1.1.0       cli_3.4.0          
##  [37] htmltools_0.5.3     tools_4.2.1         gtable_0.3.1        glue_1.6.2         
##  [41] Rcpp_1.0.9          carData_3.0-5       jquerylib_0.1.4     vctrs_0.4.1        
##  [45] svglite_2.1.0       nlme_3.1-159        insight_0.18.4      xfun_0.33          
##  [49] stringr_1.4.1       ps_1.7.1            lme4_1.1-30         rvest_1.0.3        
##  [53] lifecycle_1.0.2     rstatix_0.7.0       DEoptimR_1.0-11     MASS_7.3-58.1      
##  [57] scales_1.2.1        RColorBrewer_1.1-3  yaml_2.3.5          sass_0.4.2         
##  [61] rpart_4.1.16        latticeExtra_0.6-30 stringi_1.7.8       highr_0.9          
##  [65] bayestestR_0.13.0   checkmate_2.1.0     boot_1.3-28         rlang_1.0.5        
##  [69] pkgconfig_2.0.3     systemfonts_1.0.4   evaluate_0.16       purrr_0.3.4        
##  [73] htmlwidgets_1.5.4   labeling_0.4.2      tidyselect_1.1.2    processx_3.7.0     
##  [77] magrittr_2.0.3      R6_2.5.1            magick_2.7.3        generics_0.1.3     
##  [81] pillar_1.8.1        foreign_0.8-82      withr_2.5.0         mgcv_1.8-40        
##  [85] datawizard_0.6.0    abind_1.4-5         nnet_7.3-17         tibble_3.1.8       
##  [89] performance_0.9.2   modelr_0.1.9        car_3.1-0           interp_1.1-3       
##  [93] utf8_1.2.2          rmarkdown_2.16      jpeg_0.1-9          data.table_1.14.2  
##  [97] callr_3.7.2         digest_0.6.29       webshot_0.5.3       xtable_1.8-4       
## [101] munsell_0.5.0       viridisLite_0.4.1   bslib_0.4.0</code></pre>
<hr />
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
